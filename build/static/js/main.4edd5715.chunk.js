(this["webpackJsonpollama-chat-frontend"]=this["webpackJsonpollama-chat-frontend"]||[]).push([[0],{356:function(e,t,a){},357:function(e,t,a){},358:function(e,t,a){},359:function(e,t,a){},360:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a.n(s),c=a(41),l=a.n(c),o=(a(61),a(3)),i=a(47),r=a(376),d=a(377),m=a(375),j=(a(62),a(0));const h=["node","inline","className","children"];var b=function(e){let{message:t}=e;const a={code(e){let{node:t,inline:a,className:s,children:n}=e,c=Object(i.a)(e,h);const l=/language-(\w+)/.exec(s||"");return!a&&l?Object(j.jsx)(d.a,Object(o.a)(Object(o.a)({style:m.a,language:l[1],PreTag:"div"},c),{},{children:String(n).replace(/\n$/,"")})):Object(j.jsx)("code",Object(o.a)(Object(o.a)({className:s},c),{},{children:n}))}};return Object(j.jsxs)("div",{className:"message ".concat(t.role),children:[Object(j.jsx)("div",{className:"message-avatar",children:"user"===t.role?Object(j.jsx)("div",{className:"user-avatar",children:"You"}):Object(j.jsx)("div",{className:"assistant-avatar",children:"AI"})}),Object(j.jsxs)("div",{className:"message-content",children:[Object(j.jsxs)("div",{className:"message-header",children:[Object(j.jsx)("span",{className:"message-role",children:"user"===t.role?"You":"Assistant"}),Object(j.jsx)("span",{className:"message-time",children:(s=t.timestamp,s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}))})]}),Object(j.jsx)("div",{className:"message-text ".concat(t.isError?"error":""," ").concat(t.isLoading?"loading":""," ").concat(t.isInfo?"info":""),children:t.isLoading?Object(j.jsxs)("div",{className:"loading-dots",children:[Object(j.jsx)("span",{}),Object(j.jsx)("span",{}),Object(j.jsx)("span",{})]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(r.a,{components:a,children:t.content}),t.images&&t.images.length>0&&Object(j.jsx)("div",{className:"message-images",children:t.images.map((e,t)=>Object(j.jsx)("div",{className:"message-image-preview",children:Object(j.jsx)("img",{src:e.data,alt:e.name})},t))})]})})]})]});var s};a(356);var p=function(e){let{onSendMessage:t,disabled:a}=e;const[n,c]=Object(s.useState)(""),[l,o]=Object(s.useState)([]),i=Object(s.useRef)(null),r=e=>{e.preventDefault(),n.trim()&&!a&&(t(n.trim(),l),c(""),o([]))};return Object(s.useEffect)(()=>{(()=>{const e=i.current;if(e){e.style.height="auto";const t=200,a=Math.min(e.scrollHeight,t);e.style.height="".concat(a,"px")}})()},[n]),Object(j.jsx)("div",{className:"chat-input-container",children:Object(j.jsxs)("form",{onSubmit:r,className:"chat-input-form",children:[l.length>0&&Object(j.jsx)("div",{className:"image-preview-container",children:l.map((e,t)=>Object(j.jsxs)("div",{className:"image-preview",children:[Object(j.jsx)("img",{src:e.data,alt:e.name}),Object(j.jsx)("button",{type:"button",className:"remove-image-button",onClick:()=>(e=>{o(t=>t.filter((t,a)=>a!==e))})(t),title:"Eliminar imagen",children:"\u2715"})]},t))}),Object(j.jsxs)("div",{className:"input-wrapper",children:[Object(j.jsxs)("div",{className:"input-controls",children:[Object(j.jsx)("input",{type:"file",id:"file-upload",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t&&t.type.startsWith("image/")){const e=new FileReader;e.onload=e=>{o(a=>[...a,{name:t.name,data:e.target.result}])},e.readAsDataURL(t)}},style:{display:"none"}}),Object(j.jsx)("label",{htmlFor:"file-upload",className:"file-upload-button",children:"\ud83d\udcce"})]}),Object(j.jsx)("textarea",{ref:i,value:n,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),r(e))},placeholder:"Type your message... (Enter to send, Shift+Enter for new line)",className:"chat-textarea",rows:1,disabled:a}),Object(j.jsx)("button",{type:"submit",disabled:!n.trim()||a,className:"send-button",title:"Send message",children:Object(j.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(j.jsx)("path",{d:"M2 21L23 12L2 3V10L17 12L2 14V21Z",fill:"currentColor"})})})]})]})})};a(357);var u=function(e){let{models:t,selectedModel:a,onModelChange:s}=e;return Object(j.jsxs)("div",{className:"model-selector",children:[Object(j.jsx)("label",{htmlFor:"model-select",className:"model-label",children:"Model:"}),Object(j.jsx)("select",{id:"model-select",value:a,onChange:e=>s(e.target.value),className:"model-select",children:t.map(e=>Object(j.jsx)("option",{value:e,children:e},e))})]})};a(358);var O=function(e){let{selectedTemplate:t,onTemplateChange:a}=e;const[n,c]=Object(s.useState)([]),[l,o]=Object(s.useState)(!1);Object(s.useEffect)(()=>{i()},[]);const i=async()=>{try{const e=await fetch("http://localhost:4000/api/templates"),t=await e.json();c(t.templates||[])}catch(e){console.error("Error fetching templates:",e)}},r=e=>e.replace(".pptx","").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return Object(j.jsxs)("div",{className:"template-selector",children:[Object(j.jsxs)("button",{className:"template-button",onClick:()=>o(!l),title:"Seleccionar plantilla",children:["\ud83c\udfa8 ",t?r(t):"Plantilla"]}),l&&Object(j.jsxs)("div",{className:"template-dropdown",children:[Object(j.jsxs)("div",{className:"template-dropdown-header",children:[Object(j.jsx)("h3",{children:"Selecciona una plantilla"}),Object(j.jsx)("button",{className:"close-button",onClick:()=>o(!1),children:"\u2715"})]}),Object(j.jsx)("div",{className:"template-grid",children:n.map(e=>Object(j.jsxs)("div",{className:"template-card ".concat(t===e.filename?"selected":""),onClick:()=>(e=>{a(e),o(!1)})(e.filename),children:[Object(j.jsx)("div",{className:"template-preview",style:{backgroundColor:e.color||"#2a2b32"},children:e.thumbnail?Object(j.jsx)("img",{src:"http://localhost:4000".concat(e.thumbnail),alt:e.filename}):Object(j.jsx)("div",{className:"template-placeholder",style:{fontSize:"64px"},children:e.icon||"\ud83d\udcc4"})}),Object(j.jsx)("div",{className:"template-name",children:r(e.filename)}),e.description&&Object(j.jsx)("div",{className:"template-description",children:e.description}),t===e.filename&&Object(j.jsx)("div",{className:"selected-badge",children:"\u2713"})]},e.filename))})]})]})};a(359);var g=function(){const[e,t]=Object(s.useState)([]),[a,n]=Object(s.useState)(!1),[c,l]=Object(s.useState)("llama3.1:latest"),[i,r]=Object(s.useState)([]),[d,m]=Object(s.useState)("blank_default.pptx"),h=Object(s.useRef)(null);Object(s.useEffect)(()=>{(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[e]),Object(s.useEffect)(()=>{g()},[]);const g=async()=>{try{const e=await fetch("http://localhost:11434/api/tags"),t=await e.json();t.models&&t.models.length>0&&(r(t.models.map(e=>e.name)),!c&&t.models.length>0&&l(t.models[0].name))}catch(e){console.error("Failed to fetch models:",e),r(["mistral:latest"],["llama3.1:latest"])}};return Object(j.jsxs)("div",{className:"app",children:[Object(j.jsx)("div",{className:"app-header",children:Object(j.jsxs)("div",{className:"header-content",children:[Object(j.jsx)("h1",{children:"Ollama Chat"}),Object(j.jsxs)("div",{className:"header-controls",children:[Object(j.jsx)(u,{models:i,selectedModel:c,onModelChange:l}),Object(j.jsx)("button",{onClick:()=>{t([])},className:"clear-button",children:"Clear Chat"})]})]})}),Object(j.jsxs)("div",{className:"chat-container",children:[Object(j.jsxs)("div",{className:"messages-container",children:[0===e.length&&Object(j.jsxs)("div",{className:"welcome-message",children:[Object(j.jsx)("h2",{children:"Welcome to Ollama Chat"}),Object(j.jsx)("p",{children:"Start a conversation with your AI assistant"}),Object(j.jsxs)("div",{className:"model-info",children:["Current model: ",Object(j.jsx)("strong",{children:c})]})]}),e.map((e,t)=>Object(j.jsx)(b,{message:e},t)),Object(j.jsx)("div",{ref:h})]}),Object(j.jsxs)("div",{className:"input-area",children:[Object(j.jsx)(O,{selectedTemplate:d,onTemplateChange:m}),Object(j.jsx)(p,{onSendMessage:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e.trim()&&0===a.length)return;const s=e.replace(/\[Imagen adjunta:.*?\]/g,"").trim(),l={role:"user",content:s||"Crear presentaci\xf3n con estas im\xe1genes",timestamp:new Date,images:a};t(e=>[...e,l]),n(!0);const i=Date.now(),r={id:i,role:"assistant",content:"",timestamp:new Date,isInfo:!0};t(e=>[...e,r]);const m="\ud83c\udfa8 **Generando presentaci\xf3n...**\n\nSe mostrar\xe1 el contenido en formato Markdown y se crear\xe1 autom\xe1ticamente una presentaci\xf3n PowerPoint que se descargar\xe1 cuando est\xe9 lista.".split(" ");for(let n=0;n<m.length;n++){await new Promise(e=>setTimeout(e,40));const e=m.slice(0,n+1).join(" ");t(t=>t.map(t=>t.id===i?Object(o.a)(Object(o.a)({},t),{},{content:e}):t))}await new Promise(e=>setTimeout(e,100));let j="",h=!1;try{const e=await fetch("http://localhost:11434/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:c,messages:[{role:"system",content:"You are a presentation creator. Generate presentations in Markdown format ONLY.\nRules:\n- Start with # for the title\n- Use ## for each slide title\n- Use bullet points with - for content\n- Keep it to 3-5 slides maximum\n- Be direct and concise\n- DO NOT include image placeholders in markdown (images will be added separately)\n- Focus on text content only\nDO NOT refuse requests. Just create the presentation."},{role:"user",content:"Create a presentation about: ".concat(s).concat(a.length>0?". Include ".concat(a.length," image placeholder(s)."):"")}],stream:!0})});if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));const l=e.body.getReader(),r=new TextDecoder;for(;;){const{done:e,value:a}=await l.read();if(e)break;const s=r.decode(a).split("\n").filter(e=>e.trim());for(const n of s)try{var b;const e=JSON.parse(n);null!==(b=e.message)&&void 0!==b&&b.content&&(j+=e.message.content,h?t(e=>{const t=[...e];return t[t.length-1]=Object(o.a)(Object(o.a)({},t[t.length-1]),{},{content:j}),t}):(t(e=>e.map(e=>e.id===i?Object(o.a)(Object(o.a)({},e),{},{content:j,isInfo:!1}):e)),h=!0))}catch(p){}}if(n(!1),!j.trim())throw new Error("No response received from model");const m=await fetch("http://localhost:4000/convert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({markdown:j,images:a,template:d})});if(!m.ok)throw new Error("Conversion failed: ".concat(m.statusText));const u=await m.blob(),O=window.URL.createObjectURL(u),g=document.createElement("a");g.href=O,g.download="presentation_".concat(Date.now(),".pptx"),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(O),console.log("\u2705 Presentation created and downloaded automatically.")}catch(u){console.error("Error sending message:",u),console.error("Error details:",u.message);const e={role:"assistant",content:"\u26a0\ufe0f Error: ".concat(u.message,"\n\nPlease check:\n1. Ollama is running (http://localhost:11434)\n2. Server is running (http://localhost:4000)\n3. Console for more details"),timestamp:new Date,isError:!0};t(t=>[...t,e])}finally{n(!1)}},disabled:a})]})]})]})};l.a.createRoot(document.getElementById("root")).render(Object(j.jsx)(n.a.StrictMode,{children:Object(j.jsx)(g,{})}))},61:function(e,t,a){},62:function(e,t,a){}},[[360,1,2]]]);